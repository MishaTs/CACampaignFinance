setwd("~/Desktop/Data/JP/")
library(dplyr)
library(magrittr)
library(readr)
library(R.utils)
library(stringr)

dime1980 <- read.csv("dime/dat1980")
dime1982 <- read.csv("dime/dat1982")
dime1984 <- read.csv("dime/dat1984")
dime1986 <- read.csv("dime/dat1986")
dime1988 <- read.csv("dime/dat1988")
dime1990 <- read.csv("dime/dat1990")
dime1992 <- read.csv("dime/dat1992")
dime1994 <- read.csv("dime/dat1994")
dime1996 <- read.csv("dime/dat1996")
dime1998 <- read.csv("dime/dat1998")
dime2000 <- read.csv("dime/dat2000")
dime2002 <- read.csv("dime/dat2002")
dime2004 <- read.csv("dime/dat2004")
dime2006 <- read.csv("dime/dat2006")
dime2008 <- read.csv("dime/dat2008")
dime2010 <- read.csv("dime/dat2010")
dime2012 <- read.csv("dime/dat2012")
dime2014 <- read.csv("dime/dat2014")
dime2016 <- read.csv("dime/dat2016")
dime2018 <- read.csv("dime/dat2018")

dime1980 <- dime1980 %>% select(-X)
dime1982 <- dime1982 %>% select(-X)
dime1984 <- dime1984 %>% select(-X)
dime1986 <- dime1986 %>% select(-X)
dime1988 <- dime1988 %>% select(-X)
dime1990 <- dime1990 %>% select(-X)
dime1992 <- dime1992 %>% select(-X)
dime1994 <- dime1994 %>% select(-X)
dime1996 <- dime1996 %>% select(-X)
dime1998 <- dime1998 %>% select(-X)
dime2000 <- dime2000 %>% select(-X)
dime2002 <- dime2002 %>% select(-X)
dime2004 <- dime2004 %>% select(-X)
dime2006 <- dime2006 %>% select(-X)
dime2008 <- dime2008 %>% select(-X)
dime2010 <- dime2010 %>% select(-X)
dime2012 <- dime2012 %>% select(-X)
dime2014 <- dime2014 %>% select(-X)
dime2016 <- dime2016 %>% select(-X)
dime2018 <- dime2018 %>% select(-X)

dimeTS <- rbind(dime1980,dime1982,dime1984,dime1986,dime1988,dime1990,dime1992,dime1994,dime1996,dime1998,dime2000,dime2002,dime2004,dime2006,dime2008,dime2010,dime2012,dime2014,dime2016,dime2018)
dimeTS <- dimeTS %>% mutate(id = as.numeric(as.factor(NAMELSAD)))
write.csv(dimeTS, "~/Desktop/Data/JP/final/dimeTS.csv")

vote2002 <- read.csv("voting/vote2002")
vote2004 <- read.csv("voting/vote2004")
vote2006 <- read.csv("voting/vote2006")
vote2008 <- read.csv("voting/vote2008")
vote2010 <- read.csv("voting/vote2010")
vote2012 <- read.csv("voting/vote2012")
vote2014 <- read.csv("voting/vote2014")
vote2016 <- read.csv("voting/vote2016")
vote2018 <- read.csv("voting/vote2018")

vote2002 <- vote2002 %>% select(-X)
dat2002 <- merge(dime2002,vote2002,by="NAMELSAD")
vote2004 <- vote2004 %>% select(-X)
dat2004 <- merge(dime2004,vote2004,by="NAMELSAD")
vote2006 <- vote2006 %>% select(-X)
dat2006 <- merge(dime2006,vote2006,by="NAMELSAD")
vote2008 <- vote2008 %>% select(-X)
dat2008 <- merge(dime2008,vote2008,by="NAMELSAD")
vote2010 <- vote2010 %>% select(-X)
dat2010 <- merge(dime2010,vote2010,by="NAMELSAD")
vote2012 <- vote2012 %>% select(-X)
dat2012 <- merge(dime2012,vote2012,by="NAMELSAD")
vote2014 <- vote2014 %>% select(-X)
dat2014 <- merge(dime2014,vote2014,by="NAMELSAD")
vote2016 <- vote2016 %>% select(-X)
dat2016 <- merge(dime2016,vote2016,by="NAMELSAD")
vote2018 <- vote2018 %>% select(-X)
dat2018 <- merge(dime2018,vote2018,by="NAMELSAD")

dimeVoteTS <- rbind(dat2002,dat2004,dat2006,dat2008,dat2010,dat2012,dat2014,dat2016,dat2018)
dimeVoteTS <- dimeVoteTS %>% mutate(id = as.numeric(as.factor(NAMELSAD)))
write.csv(dimeVoteTS, "~/Desktop/Data/JP/final/dimeVoteTS.csv")

acs2006 <- read.csv("acs/acs2006")
acs2008 <- read.csv("acs/acs2008")
acs2010 <- read.csv("acs/acs2010")
acs2012 <- read.csv("acs/acs2012")
acs2014 <- read.csv("acs/acs2014")
acs2016 <- read.csv("acs/acs2016")
acs2018 <- read.csv("acs/acs2018")

acs2006 <- acs2006 %>% select(-c(X, Geo_FIPS))
colnames(acs2006)[294] <- "NAMELSAD"
draft2006 <- merge(dat2006, acs2006, by="NAMELSAD")
acs2008 <- acs2008 %>% select(-c(X, Geo_FIPS))
colnames(acs2008)[294] <- "NAMELSAD"
draft2008 <- merge(dat2008, acs2008, by="NAMELSAD")
acs2010 <- acs2010 %>% select(-c(X, Geo_FIPS))
colnames(acs2010)[294] <- "NAMELSAD"
draft2010 <- merge(dat2010, acs2010, by="NAMELSAD")
acs2012 <- acs2012 %>% select(-c(X, Geo_FIPS))
colnames(acs2012)[294] <- "NAMELSAD"
draft2012 <- merge(dat2012, acs2012, by="NAMELSAD")
acs2014 <- acs2014 %>% select(-c(X, Geo_FIPS))
colnames(acs2014)[294] <- "NAMELSAD"
draft2014 <- merge(dat2014, acs2014, by="NAMELSAD")
acs2016 <- acs2016 %>% select(-c(X, Geo_FIPS))
colnames(acs2016)[294] <- "NAMELSAD"
draft2016 <- merge(dat2016, acs2016, by="NAMELSAD")
acs2018 <- acs2018 %>% select(-c(X, Geo_FIPS))
colnames(acs2018)[294] <- "NAMELSAD"
draft2018 <- merge(dat2018, acs2018, by="NAMELSAD")


fullTS <- rbind(draft2006,draft2008,draft2010,draft2012,draft2014,draft2016,draft2018)
fullTS <- fullTS %>% select(-Geo_NAME)
fullTS <- fullTS %>% mutate(id = as.numeric(as.factor(NAMELSAD)))
write.csv(fullTS, "~/Desktop/Data/JP/final/fullTS.csv")